<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }} - {{ app_name }}</title>
</head>
<body>
    <header class="header">
        <h1>{{ app_name }}</h1>
        <p class="subtitle">{{ title }}</p>
    </header>
    
    <div class="metadata">
        <div class="metadata-row">
            <span class="metadata-label">User</span>
            <span class="metadata-value">{{ user_name }}</span>
        </div>
        <div class="metadata-row">
            <span class="metadata-label">Generated</span>
            <span class="metadata-value">{{ generation_date|date:"F j, Y \a\t H:i" }}</span>
        </div>
        <div class="metadata-row">
            <span class="metadata-label">Operation Type</span>
            <span class="metadata-value">{{ problem.operation }}</span>
        </div>
    </div>
    
    <section class="section">
        <h2 class="section-title">Problem</h2>
        <div class="problem-box">
            <div class="label">Given Expression</div>
            <div class="expression">{{ problem.input }}</div>
        </div>
    </section>
    
    {% if has_steps %}
    <section class="section">
        <h2 class="section-title">Solution Steps</h2>
        <ol class="steps-list">
            {% for step in steps %}
            <li>
                <div class="step-content">
                    {{ step.content|safe }}
                    {% if step.svg %}
                    <div style="margin-top: 10px;">{{ step.svg|safe }}</div>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        </ol>
    </section>
    {% else %}
    <section class="section">
        <h2 class="section-title">Solution</h2>
        <p class="empty-section">No step-by-step solution available for this problem.</p>
    </section>
    {% endif %}
    
    <section class="section">
        <h2 class="section-title">Final Answer</h2>
        <div class="result-box">
            <div class="label">Result</div>
            <div class="answer">{{ result.text }}</div>
            {% if result.latex_svg %}
            <div style="margin-top: 15px;">{{ result.latex_svg|safe }}</div>
            {% endif %}
        </div>
    </section>
    
    {% if has_graphs %}
    <section class="section graphs-section">
        <h2 class="section-title">Generated Graphs</h2>
        {% for graph in graphs %}
        <div class="graph-item">
            <div class="graph-expression">$${{ graph.expression }}$$</div>
            <img src="{{ graph.image }}" alt="Graph of {{ graph.expression }}">
        </div>
        {% endfor %}
    </section>
    {% endif %}
    
    <footer class="footer">
        <p>Generated by {{ app_name }} on {{ generation_date|date:"F j, Y" }}</p>
        <p>Page %s of %total%</p>
    </footer>
</body>
</html>
